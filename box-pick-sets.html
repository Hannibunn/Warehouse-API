<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sets auswählen</title>
<style>
  :root{ --bg:#f0e9e1; --panel:#fff; --ink:#1a1a1a; --muted:#888; --line:rgba(0,0,0,.12); --radius:14px; --shadow:0 8px 22px rgba(0,0,0,.12); --accent:#b48b68; }
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif}
  .container{max-width:1200px;margin:0 auto;padding:0 16px}
  h1{text-align:center;margin:24px 0 8px;font-size:clamp(32px,5vw,60px)}
  .searchbar{max-width:1000px;margin:0 auto 16px;display:flex;gap:10px;align-items:center;background:#fff;border-radius:26px;box-shadow:inset 0 0 0 1px var(--line);padding:10px 14px}
  .searchbar input{flex:1;border:none;outline:none;font-size:16px;background:transparent}
  .grid{display:grid;gap:24px;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));max-width:1200px;margin:0 auto 24px}
  .card{background:var(--panel);border:1px solid var(--line);border-radius:14px;box-shadow:var(--shadow);padding:14px;display:grid;gap:8px}
  .media{background:#e9eaec;border-radius:12px;display:grid;place-items:center;height:220px}
  .media img{max-width:100%;max-height:200px;object-fit:contain}
  .name{font-weight:700}
  .row{display:flex;gap:10px;justify-content:center;margin:8px 0 24px}
  .btn{border:none;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer}
  .primary{background:var(--accent);color:#fff}
  .ghost{background:#eee}
</style>
</head>
<body>

<div class="container">
  <h1>Sets auswählen</h1>

  <div class="searchbar">
    <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
      <path d="M21 21l-4.35-4.35M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="#666" stroke-width="2" stroke-linecap="round"/>
    </svg>
    <input id="q" placeholder="Suche" />
  </div>

  <section class="grid" id="grid"></section>

  <div class="row">
    <button class="btn ghost" id="back">Zurück</button>
    <button class="btn primary" id="accept">Accept</button>
  </div>
</div>

  <script>
   // ---------------------------
// API CONFIG
// ---------------------------
const API_BOX_BASE = "https://Setsapi.pleeging.com/api/Box"; 
const API_KEY = "TheLionwants3datelsafter20request"; 

// ---------------------------
// Box erstellen
// ---------------------------
async function createBox(draft, token) {
  try {
    const response = await fetch(API_BOX_BASE, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer " + token,
        "x-api-key": "TheLionwants3datelsafter20request"
      },
      body: JSON.stringify({
        name: draft.name,
        description: draft.description || ""
      })
    });

    if (!response.ok) {
      throw new Error("Box konnte nicht erstellt werden: " + response.status);
    }

    const box = await response.json();
    console.log("Neue Box erstellt:", box);
    return box;

  } catch (err) {
    console.error("Fehler beim Erstellen der Box:", err);
    throw err;
  }
}

// ---------------------------
// Sets zu einer Box hinzufügen
// ---------------------------
async function addSetsToBox(boxId, sets, token) {
  try {
    const response = await fetch(`${API_BOX_BASE}/${boxId}/sets`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer " + token,
        "x-api-key": "TheLionwants3datelsafter20request"
      },
      body: JSON.stringify(sets)
    });

    if (!response.ok) {
      throw new Error("Sets konnten nicht hinzugefügt werden: " + response.status);
    }

    const result = await response.json();
    console.log("Sets zur Box hinzugefügt:", result);
    return result;

  } catch (err) {
    console.error("Fehler beim Hinzufügen der Sets:", err);
    throw err;
  }
}

// ---------------------------
// Beispiel-Aufruf
// ---------------------------
(async () => {
  const token = "DEIN_JWT_TOKEN_HIER"; // <- vom Login bekommen

  // Neue Box anlegen
  const neueBox = await createBox({ 
    name: "Meine Box", 
    description: "Testbox für Sets" 
  }, token);

  // Sets zu der neuen Box hinzufügen
  await addSetsToBox(neueBox.id, [
    { setId: 101, quantity: 2 },
    { setId: 102, quantity: 1 }
  ], token);
})();

  </script>
</body>
</html>
